
## Overview

The `augmentation.py` script provides a function called `augment_image` that applies a series of transformations to an image to generate augmented versions. This is useful for increasing the size and diversity of a dataset for training a CAPTCHA solver.

The augmentations include:
- Rotation
- Shearing
- Resizing
- Grayscale conversion
- Brightness and contrast adjustments
- Gaussian blur
- Noise injection
- Adding distractor lines

## Installation

Before using the script, ensure you have the necessary dependencies installed. You can install them using pip and the `requirements.txt` file:

## Usage

To use the augmentation function, you need to import `augment_image` from the `augmentation` module.

Here is a basic example of how to use it:

```python
from PIL import Image
from augmentation.augmentation import augment_image

input_image = Image.open("image.png")

# Apply augmentations with default settings
augmented_image = augment_image(input_image)

# Or, customize the augmentations by passing arguments
custom_augmented_image = augment_image(
    input_image,
    angle_range=(-10, 10),
    shear_range=(-5, 5),
    grayscale_probability=0.5,
    blur_probability=0.5,
    lines_probability=0.2
)
```

### `augment_image` Function Parameters

The `augment_image` function accepts the following parameters to control the augmentation process:

| Parameter               | Type                            | Default        | Description                                            |
| ----------------------- | ------------------------------- | -------------- | ------------------------------------------------------ |
| `img`                   | `PIL.Image.Image`               | **Required**   | The input image to augment.                            |
| `angle_range`           | `tuple[float, float]` or `None` | `(-15, 15)`    | Rotation angle range in degrees.                       |
| `shear_range`           | `tuple[float, float]` or `None` | `(-10, 10)`    | Shear angle range in degrees.                          |
| `target_size`           | `tuple[int, int]` or `None`     | `(640, 160)`   | Target (width, height) for resizing.                   |
| `grayscale_probability` | `float`                         | `0.2`          | Probability of converting to grayscale.                |
| `brightness_range`      | `tuple[float, float]` or `None` | `(0.8, 1.2)`   | Brightness adjustment factor range.                    |
| `contrast_range`        | `tuple[float, float]` or `None` | `(0.8, 1.2)`   | Contrast adjustment factor range.                      |
| `blur_probability`      | `float`                         | `0.3`          | Probability of applying blur.                          |
| `blur_radius`           | `tuple[float, float]` or `None` | `(0.5, 2.0)`   | Gaussian blur radius range.                            |
| `noise_std`             | `tuple[float, float]` or `None` | `(0.01, 0.05)` | Noise standard deviation range.                        |
| `lines_probability`     | `float`                         | `0.1`          | Probability of adding distractor lines.                |
| `line_count`            | `tuple[int, int]` or `None`     | `(1, 3)`       | Number of lines to add.                                |
| `line_thickness`        | `tuple[int, int]` or `None`     | `(1, 4)`       | Line thickness range.                                  |

To disable a specific augmentation, you can set its corresponding parameter to `None` or a value that makes it inactive (e.g., `grayscale_probability=0.0`).

## Running the Test Script

The project includes a test script, `test_augmentation.py`, which generates a grid of images to visualize the effect of each individual augmentation.

To run it, execute the script from the root directory of the project:

```bash
python augmentation/test_augmentation.py
```

This will open a plot showing the augmentations and save it as `aug_grid.png` in the `augmentation` directory.

## Example Augmentations

Below is an example of the output grid generated by the test script, showing how each augmentation transforms the original image.

![Example Augmentations](aug_grid.png)
```
